<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<style type="text/css">
		*{
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}
        .absolute{
            position: absolute;
        }
        .align-center-legacy{
            margin: auto;

        }
        .yt-video{
        	display: flex;
        	align-self: center;

        	width: 90%;
        	height: 70vh;

        	
        	

        }
        .box{
            width:100vw;
            height: 100vh;
        }
        li{
        	list-style-type: decimal;
        }
     


    </style>
	<title>YT without bloat</title>
    <script type='text/javascript' src='config.js'></script>
    <script type="text/javascript">
        var token = config.TOKEN;

        //var input = document.getElementById("SearchText");
       // var input = document.querySelector('input');

    document.getElementById("SearchText").addEventListener("keyup", function(event) {
    
    if (event.keyCode === 13) {
    	event.preventDefault();
        searchVideos();
    }
});
        
        function loadVideo(str){
            
            video.src = "https://www.youtube.com/embed/" + str;
            relatedVideos(str);
            return 1;
        }

        function clampID() {
            var str = document.getElementById("SearchText").value;
            var finstr = "null";

            if(str.includes("https://www.youtube.com/embed/")){
                finstr = str.substring(30,str.length);
                console.log(finstr);
            }else if(str.includes("https://www.youtube.com/watch?v=")){
                finstr = str.substring(32,str.length);
                console.log(finstr);
            }else if(str.includes("www.youtube.com/watch?v=")){
                finstr = str.substring(24,str.length);
                console.log(finstr);
            }else if(str.includes("https://youtu.be/")){
                finstr = str.substring(17,str.length);
                console.log(finstr);
            }else{
                finstr = str;
            }
           

            if(finstr!="null"){
                loadVideo(finstr);
            }

             return finstr;
        }
        
        async function searchVideos(){
            let str = document.getElementById("SearchText").value;
             let list = document.getElementById("searchlist").getElementsByTagName("li");
             let srch = document.getElementById("searchstatus");
             //list[1].innerHTML = "ass";
             //list[1].setAttribute("onClick","loadVideo('"+str+"')");
             srch.innerHTML = "Searching...";


            let promise = fetch("https://youtube.googleapis.com/youtube/v3/search?part=snippet&q="+str+"&maxResults=15&type=video&key=" + token + "");

            let response = await promise;

           

            if (response.ok){
            let json = await response.json();
            srch.innerHTML = "Search Results for "+str+"";



            for (var i = 0; i <= 15; i++) {
               // console.log(json.items[i].snippet.title);
                list[i].innerHTML = "<a href='#'>"+json.items[i].snippet.title+"</a>";
             list[i].setAttribute("onClick","loadVideo('"+json.items[i].id.videoId+"')");
                
            }
              }
              return 1;
            }

            async function relatedVideos(string){
             let list = document.getElementById("relatedlist").getElementsByTagName("li");


            let promise = fetch("https://youtube.googleapis.com/youtube/v3/search?part=snippet&relatedToVideoId="+string+"&maxResults=15&type=video&key=" + token + "");

            let response = await promise;

           

            if (response.ok){
            let json = await response.json();
            for (var i = 0; i <= 15; i++) {
               // console.log(json.items[i].snippet.title);
                list[i].innerHTML = "<a href='#'>"+json.items[i].snippet.title+"</a>";
             list[i].setAttribute("onClick","loadVideo('"+json.items[i].id.videoId+"')");
                
            }
              }
              return 1;
            }


            
    </script>
	</head>
<body>
	<div class="box align-center-legacy"> <!-- Vedaet -->
		
			<form class="" onsubmit="searchVideos()">
	<input type="text" style="width: 75%; height: 20%"  placeholder="Search" id="SearchText"></textarea>
	<button type="button"  id="loadVideo" style="width: 20%;" onclick="searchVideos()">Search</button>
	</form>
    <iframe id="video" class = "align-center-legacy yt-video" width="720" height="420" src="https://www.youtube.com/embed/WHujzgKlPqM" title="YouTube video player" frameborder="0" allowfullscreen></iframe>

    <div class="searchresults">
        <p id="searchstatus">Search Results</p>
            <ul id="searchlist">
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
            </ul>

    </div>

    <div class="relatedresults">
        <p id="relatedstatus">Related Videos</p>
            <ul id="relatedlist">
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
               <li onclick="loadVideo('')"></li>
            </ul>

    </div>
</div>

	
</body>
</html>